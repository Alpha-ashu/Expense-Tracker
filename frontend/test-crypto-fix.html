<!DOCTYPE html>
<html>
<head>
    <title>Crypto Fix Test</title>
</head>
<body>
    <h1>Crypto Module Fix Test</h1>
    <button onclick="testDeviceId()">Test Device ID Generation</button>
    <button onclick="testDeviceInfo()">Test Device Info</button>
    <div id="result"></div>
    
    <script>
        function testDeviceId() {
            try {
                // Simulate the device ID generation logic
                const timestamp = Date.now().toString();
                let random = '';
                
                if (typeof window !== 'undefined' && window.crypto && window.crypto.getRandomValues) {
                    const array = new Uint8Array(16);
                    window.crypto.getRandomValues(array);
                    random = Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
                } else {
                    random = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
                }
                
                const deviceId = `device_${timestamp}_${random}`;
                document.getElementById('result').innerHTML = `
                    <div style="background: #d4edda; padding: 10px; margin: 10px 0; border-radius: 5px;">
                        <strong>✅ Device ID Generated Successfully:</strong><br>
                        ${deviceId}
                    </div>
                `;
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <div style="background: #f8d7da; padding: 10px; margin: 10px 0; border-radius: 5px;">
                        <strong>❌ Device ID Generation Failed:</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }
        
        function testDeviceInfo() {
            try {
                let deviceName = 'Unknown Device';
                let deviceType = 'desktop';
                let platform = 'unknown';
                
                if (typeof navigator !== 'undefined') {
                    deviceName = navigator.userAgent.includes('Mobile') ? 'Mobile Device' : 'Desktop Device';
                    
                    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                        if (/iPad/i.test(navigator.userAgent)) {
                            deviceType = 'tablet';
                        } else {
                            deviceType = 'mobile';
                        }
                    }
                    
                    if (navigator.userAgent.includes('Windows')) platform = 'windows';
                    else if (navigator.userAgent.includes('Mac')) platform = 'macos';
                    else if (navigator.userAgent.includes('Linux')) platform = 'linux';
                    else if (navigator.userAgent.includes('Android')) platform = 'android';
                    else if (navigator.userAgent.includes('iOS') || navigator.userAgent.includes('iPhone')) platform = 'ios';
                    else platform = 'web';
                }
                
                document.getElementById('result').innerHTML = `
                    <div style="background: #d4edda; padding: 10px; margin: 10px 0; border-radius: 5px;">
                        <strong>✅ Device Info Generated Successfully:</strong><br>
                        Device Name: ${deviceName}<br>
                        Device Type: ${deviceType}<br>
                        Platform: ${platform}<br>
                        User Agent: ${navigator.userAgent.substring(0, 100)}...
                    </div>
                `;
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <div style="background: #f8d7da; padding: 10px; margin: 10px 0; border-radius: 5px;">
                        <strong>❌ Device Info Generation Failed:</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
