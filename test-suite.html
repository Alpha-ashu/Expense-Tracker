<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker - Comprehensive Test Suite</title>
    <style>
        :root {
            --primary-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --bg-color: #f8f9fa;
            --text-color: #333;
            --card-bg: #fff;
            --border-color: #dee2e6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .test-section {
            margin-bottom: 40px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
        }

        .section-header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 20px;
            font-weight: bold;
            font-size: 18px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .test-card {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 20px;
            background: #fafafa;
        }

        .test-card h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .test-info {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .credentials-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .credentials-box h4 {
            margin-top: 0;
            color: #856404;
        }

        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-danger {
            background-color: var(--danger-color);
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: #333;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .status-pass { background-color: #d4edda; color: #155724; }
        .status-fail { background-color: #f8d7da; color: #721c24; }
        .status-pending { background-color: #fff3cd; color: #856404; }
        .status-warning { background-color: #d1ecf1; color: #0c5460; }

        .result-display {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .result-success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .result-error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .result-info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Expense Tracker - Comprehensive Test Suite</h1>
        
        <div class="credentials-box">
            <h4>üîê Admin Test Credentials</h4>
            <p><strong>Email:</strong> shaik.job.details@gmail.com</p>
            <p><strong>Password:</strong> 123456789</p>
            <p><strong>PIN:</strong> 123456</p>
        </div>

        <div class="test-section">
            <div class="section-header">üåê Server Connectivity Tests</div>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Frontend Server</h3>
                    <div class="test-info">Testing connection to frontend development server</div>
                    <button class="btn" onclick="testFrontend()">Test Connection</button>
                    <span id="frontend-status" class="status-badge status-pending">Pending</span>
                    <div id="frontend-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Backend API Server</h3>
                    <div class="test-info">Testing connection to backend API server</div>
                    <button class="btn" onclick="testBackend()">Test Connection</button>
                    <span id="backend-status" class="status-badge status-pending">Pending</span>
                    <div id="backend-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Database Connection</h3>
                    <div class="test-info">Testing database connectivity and health</div>
                    <button class="btn" onclick="testDatabase()">Test Connection</button>
                    <span id="db-status" class="status-badge status-pending">Pending</span>
                    <div id="db-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Real-time WebSocket</h3>
                    <div class="test-info">Testing WebSocket connection for real-time updates</div>
                    <button class="btn" onclick="testWebSocket()">Test Connection</button>
                    <span id="ws-status" class="status-badge status-pending">Pending</span>
                    <div id="ws-result" class="result-display hidden"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="section-header">üîê Authentication & Authorization Tests</div>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Admin Login</h3>
                    <div class="test-info">Testing admin login with provided credentials</div>
                    <button class="btn" onclick="testAdminLogin()">Test Login</button>
                    <span id="login-status" class="status-badge status-pending">Pending</span>
                    <div id="login-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Role-Based Access</h3>
                    <div class="test-info">Testing admin role permissions and access control</div>
                    <button class="btn" onclick="testRoleAccess()">Test Access</button>
                    <span id="role-status" class="status-badge status-pending">Pending</span>
                    <div id="role-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Session Management</h3>
                    <div class="test-info">Testing session persistence and security</div>
                    <button class="btn" onclick="testSession()">Test Session</button>
                    <span id="session-status" class="status-badge status-pending">Pending</span>
                    <div id="session-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Security Features</h3>
                    <div class="test-info">Testing PIN authentication and security measures</div>
                    <button class="btn" onclick="testSecurity()">Test Security</button>
                    <span id="security-status" class="status-badge status-pending">Pending</span>
                    <div id="security-result" class="result-display hidden"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="section-header">üì± Page & Component Tests</div>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Dashboard Page</h3>
                    <div class="test-info">Testing dashboard functionality and data display</div>
                    <button class="btn" onclick="testDashboard()">Test Dashboard</button>
                    <span id="dashboard-status" class="status-badge status-pending">Pending</span>
                    <div id="dashboard-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Expense Management</h3>
                    <div class="test-info">Testing expense creation, editing, and deletion</div>
                    <button class="btn" onclick="testExpenses()">Test Expenses</button>
                    <span id="expenses-status" class="status-badge status-pending">Pending</span>
                    <div id="expenses-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Transfer Functionality</h3>
                    <div class="test-info">Testing fund transfers between accounts</div>
                    <button class="btn" onclick="testTransfers()">Test Transfers</button>
                    <span id="transfers-status" class="status-badge status-pending">Pending</span>
                    <div id="transfers-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Reports & Analytics</h3>
                    <div class="test-info">Testing report generation and data visualization</div>
                    <button class="btn" onclick="testReports()">Test Reports</button>
                    <span id="reports-status" class="status-badge status-pending">Pending</span>
                    <div id="reports-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Settings & Configuration</h3>
                    <div class="test-info">Testing user settings and application configuration</div>
                    <button class="btn" onclick="testSettings()">Test Settings</button>
                    <span id="settings-status" class="status-badge status-pending">Pending</span>
                    <div id="settings-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Notifications</h3>
                    <div class="test-info">Testing notification system and alerts</div>
                    <button class="btn" onclick="testNotifications()">Test Notifications</button>
                    <span id="notifications-status" class="status-badge status-pending">Pending</span>
                    <div id="notifications-result" class="result-display hidden"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="section-header">‚ö° Performance & Integration Tests</div>
            <div class="test-grid">
                <div class="test-card">
                    <h3>API Response Times</h3>
                    <div class="test-info">Testing API performance and response times</div>
                    <button class="btn" onclick="testPerformance()">Test Performance</button>
                    <span id="performance-status" class="status-badge status-pending">Pending</span>
                    <div id="performance-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Data Synchronization</h3>
                    <div class="test-info">Testing data sync between frontend and backend</div>
                    <button class="btn" onclick="testSync()">Test Sync</button>
                    <span id="sync-status" class="status-badge status-pending">Pending</span>
                    <div id="sync-result" class="result-display hidden"></div>
                </div>

                <div class="test-card">
                    <h3>Error Handling</h3>
                    <div class="test-info">Testing error scenarios and graceful handling</div>
                    <button class="btn" onclick="testErrors()">Test Errors</button>
                    <span id="errors-status" class="status-badge status-pending">Pending</span>
                    <div id="errors-result" class="result-display hidden"></div>
                </div>

                <div class="test-card full-width">
                    <h3>Complete Test Suite</h3>
                    <div class="test-info">Run all tests automatically and generate comprehensive report</div>
                    <button class="btn btn-warning" onclick="runAllTests()">Run All Tests</button>
                    <button class="btn btn-success" onclick="generateReport()">Generate Report</button>
                    <span id="all-tests-status" class="status-badge status-pending">Pending</span>
                    <div id="all-tests-result" class="result-display hidden"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <div class="section-header">üìä Test Results Summary</div>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Overall Status</h3>
                    <div id="overall-status" class="status-badge status-pending">Running Tests...</div>
                    <div style="margin-top: 15px;">
                        <p>Total Tests: <span id="total-tests">0</span></p>
                        <p>Passed: <span id="passed-tests" style="color: var(--success-color); font-weight: bold;">0</span></p>
                        <p>Failed: <span id="failed-tests" style="color: var(--danger-color); font-weight: bold;">0</span></p>
                        <p>Success Rate: <span id="success-rate" style="font-weight: bold;">0%</span></p>
                    </div>
                </div>

                <div class="test-card">
                    <h3>Quick Actions</h3>
                    <div class="test-info">Navigate to application or refresh tests</div>
                    <button class="btn" onclick="window.open('http://localhost:5173', '_blank')">Open Frontend</button>
                    <button class="btn" onclick="location.reload()">Refresh Tests</button>
                    <button class="btn" onclick="clearResults()">Clear Results</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test configuration
        const CONFIG = {
            frontendUrl: 'http://localhost:5173',
            backendUrl: 'http://localhost:3001',
            adminCredentials: {
                email: 'shaik.job.details@gmail.com',
                password: '123456789',
                pin: '123456'
            }
        };

        let testResults = {};

        // Utility functions
        function setStatus(elementId, status, message = '') {
            const statusEl = document.getElementById(elementId + '-status');
            const resultEl = document.getElementById(elementId + '-result');
            
            statusEl.className = 'status-badge status-' + status;
            statusEl.textContent = message || (status === 'pass' ? 'Passed' : status === 'fail' ? 'Failed' : status === 'warning' ? 'Warning' : 'Pending');
            
            if (resultEl) {
                resultEl.className = 'result-display ' + (status === 'pass' ? 'result-success' : status === 'fail' ? 'result-error' : 'result-info');
                resultEl.classList.remove('hidden');
            }
        }

        function updateResult(elementId, message, isError = false) {
            const resultEl = document.getElementById(elementId + '-result');
            if (resultEl) {
                resultEl.innerHTML += (resultEl.innerHTML ? '\n' : '') + message;
                resultEl.scrollTop = resultEl.scrollHeight;
            }
        }

        function showLoading(elementId) {
            const statusEl = document.getElementById(elementId + '-status');
            statusEl.innerHTML = '<span class="loading"></span> Testing...';
        }

        // Test functions
        async function testFrontend() {
            showLoading('frontend');
            try {
                const response = await fetch(CONFIG.frontendUrl, { method: 'HEAD' });
                if (response.ok) {
                    setStatus('frontend', 'pass', 'Frontend server accessible');
                    updateResult('frontend', '‚úì Frontend server responding on port 5173');
                } else {
                    setStatus('frontend', 'fail', 'Frontend server error');
                    updateResult('frontend', '‚úó Frontend server returned error: ' + response.status, true);
                }
            } catch (error) {
                setStatus('frontend', 'fail', 'Frontend server unreachable');
                updateResult('frontend', '‚úó Frontend server error: ' + error.message, true);
            }
        }

        async function testBackend() {
            showLoading('backend');
            try {
                const response = await fetch(CONFIG.backendUrl + '/api/health');
                if (response.ok) {
                    const data = await response.json();
                    setStatus('backend', 'pass', 'Backend API accessible');
                    updateResult('backend', '‚úì Backend API responding on port 3001');
                    updateResult('backend', '‚úì Health check: ' + JSON.stringify(data));
                } else {
                    setStatus('backend', 'fail', 'Backend API error');
                    updateResult('backend', '‚úó Backend API returned error: ' + response.status, true);
                }
            } catch (error) {
                setStatus('backend', 'fail', 'Backend API unreachable');
                updateResult('backend', '‚úó Backend API error: ' + error.message, true);
            }
        }

        async function testDatabase() {
            showLoading('db');
            try {
                const response = await fetch(CONFIG.backendUrl + '/api/health/db');
                if (response.ok) {
                    const data = await response.json();
                    setStatus('db', 'pass', 'Database connected');
                    updateResult('db', '‚úì Database connection successful');
                    updateResult('db', '‚úì Database status: ' + JSON.stringify(data));
                } else {
                    setStatus('db', 'fail', 'Database connection failed');
                    updateResult('db', '‚úó Database error: ' + response.status, true);
                }
            } catch (error) {
                setStatus('db', 'fail', 'Database unreachable');
                updateResult('db', '‚úó Database error: ' + error.message, true);
            }
        }

        function testWebSocket() {
            showLoading('ws');
            try {
                const ws = new WebSocket('ws://localhost:3001');
                ws.onopen = () => {
                    setStatus('ws', 'pass', 'WebSocket connected');
                    updateResult('ws', '‚úì WebSocket connection established');
                    ws.close();
                };
                ws.onerror = () => {
                    setStatus('ws', 'fail', 'WebSocket connection failed');
                    updateResult('ws', '‚úó WebSocket connection error', true);
                };
                ws.onclose = () => {
                    updateResult('ws', '‚úì WebSocket connection closed gracefully');
                };
            } catch (error) {
                setStatus('ws', 'fail', 'WebSocket error');
                updateResult('ws', '‚úó WebSocket error: ' + error.message, true);
            }
        }

        async function testAdminLogin() {
            showLoading('login');
            try {
                const response = await fetch(CONFIG.backendUrl + '/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: CONFIG.adminCredentials.email,
                        password: CONFIG.adminCredentials.password
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    setStatus('login', 'pass', 'Admin login successful');
                    updateResult('login', '‚úì Admin login successful');
                    updateResult('login', '‚úì User ID: ' + data.userId);
                    updateResult('login', '‚úì Role: ' + data.role);
                    testResults.login = true;
                } else {
                    setStatus('login', 'fail', 'Admin login failed');
                    updateResult('login', '‚úó Admin login failed: ' + response.status, true);
                    testResults.login = false;
                }
            } catch (error) {
                setStatus('login', 'fail', 'Login error');
                updateResult('login', '‚úó Login error: ' + error.message, true);
                testResults.login = false;
            }
        }

        async function testRoleAccess() {
            showLoading('role');
            try {
                // First login to get token
                const loginResponse = await fetch(CONFIG.backendUrl + '/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(CONFIG.adminCredentials)
                });

                if (loginResponse.ok) {
                    const loginData = await loginResponse.json();
                    
                    // Test admin-only endpoints
                    const adminResponse = await fetch(CONFIG.backendUrl + '/api/admin/users', {
                        headers: { 'Authorization': 'Bearer ' + loginData.token }
                    });

                    if (adminResponse.ok) {
                        setStatus('role', 'pass', 'Admin role access granted');
                        updateResult('role', '‚úì Admin role permissions working correctly');
                        updateResult('role', '‚úì Admin endpoints accessible');
                        testResults.role = true;
                    } else {
                        setStatus('role', 'fail', 'Admin role access denied');
                        updateResult('role', '‚úó Admin role access failed: ' + adminResponse.status, true);
                        testResults.role = false;
                    }
                } else {
                    setStatus('role', 'fail', 'Cannot test without login');
                    updateResult('role', '‚úó Login required for role testing', true);
                    testResults.role = false;
                }
            } catch (error) {
                setStatus('role', 'fail', 'Role testing error');
                updateResult('role', '‚úó Role testing error: ' + error.message, true);
                testResults.role = false;
            }
        }

        async function testSession() {
            showLoading('session');
            try {
                // Test session persistence
                const response = await fetch(CONFIG.backendUrl + '/api/auth/session', {
                    method: 'GET',
                    credentials: 'include'
                });

                if (response.ok) {
                    setStatus('session', 'pass', 'Session management working');
                    updateResult('session', '‚úì Session persistence verified');
                    testResults.session = true;
                } else {
                    setStatus('session', 'fail', 'Session management failed');
                    updateResult('session', '‚úó Session error: ' + response.status, true);
                    testResults.session = false;
                }
            } catch (error) {
                setStatus('session', 'fail', 'Session error');
                updateResult('session', '‚úó Session error: ' + error.message, true);
                testResults.session = false;
            }
        }

        async function testSecurity() {
            showLoading('security');
            try {
                // Test PIN authentication
                const response = await fetch(CONFIG.backendUrl + '/api/auth/pin', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: CONFIG.adminCredentials.email,
                        pin: CONFIG.adminCredentials.pin
                    })
                });

                if (response.ok) {
                    setStatus('security', 'pass', 'Security features working');
                    updateResult('security', '‚úì PIN authentication successful');
                    testResults.security = true;
                } else {
                    setStatus('security', 'fail', 'Security features failed');
                    updateResult('security', '‚úó PIN authentication failed: ' + response.status, true);
                    testResults.security = false;
                }
            } catch (error) {
                setStatus('security', 'fail', 'Security error');
                updateResult('security', '‚úó Security error: ' + error.message, true);
                testResults.security = false;
            }
        }

        async function testDashboard() {
            showLoading('dashboard');
            try {
                // Test dashboard data loading
                const response = await fetch(CONFIG.backendUrl + '/api/dashboard', {
                    headers: { 'Authorization': 'Bearer ' + (await getAuthToken()) }
                });

                if (response.ok) {
                    const data = await response.json();
                    setStatus('dashboard', 'pass', 'Dashboard functionality working');
                    updateResult('dashboard', '‚úì Dashboard data loaded successfully');
                    updateResult('dashboard', '‚úì Dashboard components accessible');
                    testResults.dashboard = true;
                } else {
                    setStatus('dashboard', 'fail', 'Dashboard functionality failed');
                    updateResult('dashboard', '‚úó Dashboard error: ' + response.status, true);
                    testResults.dashboard = false;
                }
            } catch (error) {
                setStatus('dashboard', 'fail', 'Dashboard error');
                updateResult('dashboard', '‚úó Dashboard error: ' + error.message, true);
                testResults.dashboard = false;
            }
        }

        async function testExpenses() {
            showLoading('expenses');
            try {
                // Test expense creation
                const expenseData = {
                    amount: 100,
                    category: 'Food',
                    description: 'Test expense',
                    date: new Date().toISOString()
                };

                const response = await fetch(CONFIG.backendUrl + '/api/expenses', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + (await getAuthToken())
                    },
                    body: JSON.stringify(expenseData)
                });

                if (response.ok) {
                    setStatus('expenses', 'pass', 'Expense management working');
                    updateResult('expenses', '‚úì Expense creation successful');
                    updateResult('expenses', '‚úì Expense management functions accessible');
                    testResults.expenses = true;
                } else {
                    setStatus('expenses', 'fail', 'Expense management failed');
                    updateResult('expenses', '‚úó Expense error: ' + response.status, true);
                    testResults.expenses = false;
                }
            } catch (error) {
                setStatus('expenses', 'fail', 'Expense error');
                updateResult('expenses', '‚úó Expense error: ' + error.message, true);
                testResults.expenses = false;
            }
        }

        async function testTransfers() {
            showLoading('transfers');
            try {
                // Test transfer functionality
                const transferData = {
                    fromAccount: 'account1',
                    toAccount: 'account2',
                    amount: 50,
                    description: 'Test transfer'
                };

                const response = await fetch(CONFIG.backendUrl + '/api/transfers', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + (await getAuthToken())
                    },
                    body: JSON.stringify(transferData)
                });

                if (response.ok) {
                    setStatus('transfers', 'pass', 'Transfer functionality working');
                    updateResult('transfers', '‚úì Transfer creation successful');
                    updateResult('transfers', '‚úì Transfer management functions accessible');
                    testResults.transfers = true;
                } else {
                    setStatus('transfers', 'fail', 'Transfer functionality failed');
                    updateResult('transfers', '‚úó Transfer error: ' + response.status, true);
                    testResults.transfers = false;
                }
            } catch (error) {
                setStatus('transfers', 'fail', 'Transfer error');
                updateResult('transfers', '‚úó Transfer error: ' + error.message, true);
                testResults.transfers = false;
            }
        }

        async function testReports() {
            showLoading('reports');
            try {
                // Test report generation
                const response = await fetch(CONFIG.backendUrl + '/api/reports/summary', {
                    headers: { 'Authorization': 'Bearer ' + (await getAuthToken()) }
                });

                if (response.ok) {
                    const data = await response.json();
                    setStatus('reports', 'pass', 'Reports functionality working');
                    updateResult('reports', '‚úì Report generation successful');
                    updateResult('reports', '‚úì Analytics functions accessible');
                    testResults.reports = true;
                } else {
                    setStatus('reports', 'fail', 'Reports functionality failed');
                    updateResult('reports', '‚úó Report error: ' + response.status, true);
                    testResults.reports = false;
                }
            } catch (error) {
                setStatus('reports', 'fail', 'Report error');
                updateResult('reports', '‚úó Report error: ' + error.message, true);
                testResults.reports = false;
            }
        }

        async function testSettings() {
            showLoading('settings');
            try {
                // Test settings access
                const response = await fetch(CONFIG.backendUrl + '/api/settings', {
                    headers: { 'Authorization': 'Bearer ' + (await getAuthToken()) }
                });

                if (response.ok) {
                    const data = await response.json();
                    setStatus('settings', 'pass', 'Settings functionality working');
                    updateResult('settings', '‚úì Settings access successful');
                    updateResult('settings', '‚úì Configuration functions accessible');
                    testResults.settings = true;
                } else {
                    setStatus('settings', 'fail', 'Settings functionality failed');
                    updateResult('settings', '‚úó Settings error: ' + response.status, true);
                    testResults.settings = false;
                }
            } catch (error) {
                setStatus('settings', 'fail', 'Settings error');
                updateResult('settings', '‚úó Settings error: ' + error.message, true);
                testResults.settings = false;
            }
        }

        async function testNotifications() {
            showLoading('notifications');
            try {
                // Test notifications
                const response = await fetch(CONFIG.backendUrl + '/api/notifications', {
                    headers: { 'Authorization': 'Bearer ' + (await getAuthToken()) }
                });

                if (response.ok) {
                    const data = await response.json();
                    setStatus('notifications', 'pass', 'Notifications working');
                    updateResult('notifications', '‚úì Notifications system accessible');
                    updateResult('notifications', '‚úì Alert functions working');
                    testResults.notifications = true;
                } else {
                    setStatus('notifications', 'fail', 'Notifications failed');
                    updateResult('notifications', '‚úó Notifications error: ' + response.status, true);
                    testResults.notifications = false;
                }
            } catch (error) {
                setStatus('notifications', 'fail', 'Notifications error');
                updateResult('notifications', '‚úó Notifications error: ' + error.message, true);
                testResults.notifications = false;
            }
        }

        async function testPerformance() {
            showLoading('performance');
            try {
                const startTime = Date.now();
                const response = await fetch(CONFIG.backendUrl + '/api/health');
                const endTime = Date.now();
                
                const responseTime = endTime - startTime;
                
                if (response.ok && responseTime < 1000) {
                    setStatus('performance', 'pass', 'Performance acceptable');
                    updateResult('performance', '‚úì API response time: ' + responseTime + 'ms');
                    updateResult('performance', '‚úì Performance within acceptable limits');
                    testResults.performance = true;
                } else {
                    setStatus('performance', 'warning', 'Performance concerns');
                    updateResult('performance', '‚ö† API response time: ' + responseTime + 'ms');
                    updateResult('performance', '‚ö† Performance may need optimization');
                    testResults.performance = false;
                }
            } catch (error) {
                setStatus('performance', 'fail', 'Performance test failed');
                updateResult('performance', '‚úó Performance error: ' + error.message, true);
                testResults.performance = false;
            }
        }

        async function testSync() {
            showLoading('sync');
            try {
                // Test data synchronization
                const response = await fetch(CONFIG.backendUrl + '/api/sync/status', {
                    headers: { 'Authorization': 'Bearer ' + (await getAuthToken()) }
                });

                if (response.ok) {
                    const data = await response.json();
                    setStatus('sync', 'pass', 'Data sync working');
                    updateResult('sync', '‚úì Data synchronization successful');
                    updateResult('sync', '‚úì Sync status: ' + JSON.stringify(data));
                    testResults.sync = true;
                } else {
                    setStatus('sync', 'fail', 'Data sync failed');
                    updateResult('sync', '‚úó Sync error: ' + response.status, true);
                    testResults.sync = false;
                }
            } catch (error) {
                setStatus('sync', 'fail', 'Sync error');
                updateResult('sync', '‚úó Sync error: ' + error.message, true);
                testResults.sync = false;
            }
        }

        async function testErrors() {
            showLoading('errors');
            try {
                // Test error handling with invalid request
                const response = await fetch(CONFIG.backendUrl + '/api/invalid-endpoint', {
                    method: 'GET'
                });

                if (response.status === 404) {
                    setStatus('errors', 'pass', 'Error handling working');
                    updateResult('errors', '‚úì 404 error handled gracefully');
                    updateResult('errors', '‚úì Error responses properly formatted');
                    testResults.errors = true;
                } else {
                    setStatus('errors', 'fail', 'Error handling failed');
                    updateResult('errors', '‚úó Unexpected error response: ' + response.status, true);
                    testResults.errors = false;
                }
            } catch (error) {
                setStatus('errors', 'pass', 'Network error handled');
                updateResult('errors', '‚úì Network errors handled gracefully');
                testResults.errors = true;
            }
        }

        async function getAuthToken() {
            // Simple token retrieval for testing
            return localStorage.getItem('authToken') || '';
        }

        async function runAllTests() {
            showLoading('all-tests');
            setStatus('all-tests', 'pending', 'Running comprehensive tests...');
            
            // Run all tests sequentially
            await testFrontend();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testBackend();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testDatabase();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            testWebSocket();
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            await testAdminLogin();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testRoleAccess();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testSession();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testSecurity();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testDashboard();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testExpenses();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testTransfers();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testReports();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testSettings();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testNotifications();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testPerformance();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testSync();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testErrors();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            setStatus('all-tests', 'pass', 'All tests completed');
            updateResult('all-tests', '‚úì Comprehensive test suite completed');
            generateReport();
        }

        function generateReport() {
            const totalTests = Object.keys(testResults).length;
            const passedTests = Object.values(testResults).filter(result => result === true).length;
            const failedTests = totalTests - passedTests;
            const successRate = totalTests > 0 ? Math.round((passedTests / totalTests) * 100) : 0;

            document.getElementById('total-tests').textContent = totalTests;
            document.getElementById('passed-tests').textContent = passedTests;
            document.getElementById('failed-tests').textContent = failedTests;
            document.getElementById('success-rate').textContent = successRate + '%';

            const overallStatus = document.getElementById('overall-status');
            if (successRate === 100) {
                overallStatus.className = 'status-badge status-pass';
                overallStatus.textContent = 'All Tests Passed ‚úì';
            } else if (successRate >= 80) {
                overallStatus.className = 'status-badge status-warning';
                overallStatus.textContent = 'Most Tests Passed ‚ö†';
            } else {
                overallStatus.className = 'status-badge status-fail';
                overallStatus.textContent = 'Tests Failed ‚úó';
            }

            updateResult('all-tests', '\n=== TEST SUMMARY ===');
            updateResult('all-tests', 'Total Tests: ' + totalTests);
            updateResult('all-tests', 'Passed: ' + passedTests);
            updateResult('all-tests', 'Failed: ' + failedTests);
            updateResult('all-tests', 'Success Rate: ' + successRate + '%');
        }

        function clearResults() {
            // Reset all test results
            const statusElements = document.querySelectorAll('.status-badge');
            statusElements.forEach(el => {
                el.className = 'status-badge status-pending';
                el.textContent = 'Pending';
            });

            const resultElements = document.querySelectorAll('.result-display');
            resultElements.forEach(el => {
                el.innerHTML = '';
                el.classList.add('hidden');
            });

            testResults = {};
            document.getElementById('total-tests').textContent = '0';
            document.getElementById('passed-tests').textContent = '0';
            document.getElementById('failed-tests').textContent = '0';
            document.getElementById('success-rate').textContent = '0%';
            document.getElementById('overall-status').className = 'status-badge status-pending';
            document.getElementById('overall-status').textContent = 'Running Tests...';
        }
    </script>
</body>
</html>